<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROI-калькулятор</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState } = React;

        // Иконки (упрощенная версия)
        const Calculator = () => (
            <svg className="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <rect x="4" y="2" width="16" height="20" rx="2" strokeWidth="2"/>
                <line x1="8" y1="6" x2="16" y2="6" strokeWidth="2"/>
                <line x1="8" y1="10" x2="16" y2="10" strokeWidth="2"/>
                <line x1="8" y1="14" x2="16" y2="14" strokeWidth="2"/>
            </svg>
        );

        const Plus = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <line x1="12" y1="5" x2="12" y2="19" strokeWidth="2"/>
                <line x1="5" y1="12" x2="19" y2="12" strokeWidth="2"/>
            </svg>
        );

        const Trash2 = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <polyline points="3 6 5 6 21 6" strokeWidth="2"/>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" strokeWidth="2"/>
            </svg>
        );

        function ROICalculator() {
          const [implementationCost, setImplementationCost] = useState(1000000);
          const [processes, setProcesses] = useState([
            {
              id: 1,
              name: 'Массовая обработка документов',
              timeBefore: 20,
              timeAfter: 3,
              hourlyCost: 650,
              tasksPerMonth: 2000
            },
            {
              id: 2,
              name: 'HR-процессы (скрининг резюме, онбординг)',
              timeBefore: 60,
              timeAfter: 15,
              hourlyCost: 650,
              tasksPerMonth: 300
            }
          ]);

          const addProcess = () => {
            setProcesses([
              ...processes,
              {
                id: Date.now(),
                name: '',
                timeBefore: 0,
                timeAfter: 0,
                hourlyCost: 0,
                tasksPerMonth: 0
              }
            ]);
          };

          const removeProcess = (id) => {
            setProcesses(processes.filter(p => p.id !== id));
          };

          const updateProcess = (id, field, value) => {
            setProcesses(processes.map(p => 
              p.id === id ? { ...p, [field]: value } : p
            ));
          };

          const calculateProcessSavings = (process) => {
            const timeSaved = process.timeBefore - process.timeAfter;
            const monthlySavings = (timeSaved / 60) * process.hourlyCost * process.tasksPerMonth;
            const yearlySavings = monthlySavings * 12;
            return { monthlySavings, yearlySavings };
          };

          const totalYearlySavings = processes.reduce((sum, process) => {
            return sum + calculateProcessSavings(process).yearlySavings;
          }, 0);

          const roi = implementationCost > 0 ? ((totalYearlySavings - implementationCost) / implementationCost) * 100 : 0;
          const paybackMonths = totalYearlySavings > 0 ? (implementationCost / (totalYearlySavings / 12)) : 0;

          const formatNumber = (num) => {
            return new Intl.NumberFormat('ru-RU').format(Math.round(num));
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-2 sm:p-4">
              <div className="max-w-4xl mx-auto">
                <div className="bg-white rounded-lg shadow-xl p-3 sm:p-4">
                  <div className="flex items-center gap-2 mb-3">
                    <Calculator />
                    <h1 className="text-lg sm:text-xl font-bold text-gray-800">ROI-калькулятор</h1>
                  </div>
                  
                  <div className="bg-indigo-50 rounded-lg p-2 mb-3">
                    <label className="block text-xs font-semibold text-gray-700 mb-1">
                      Стоимость внедрения (₽)
                    </label>
                    <input
                      type="text"
                      value={formatNumber(implementationCost)}
                      onChange={(e) => {
                        const value = e.target.value.replace(/\s/g, '');
                        if (!isNaN(value) && value !== '') {
                          setImplementationCost(Number(value));
                        } else if (value === '') {
                          setImplementationCost(0);
                        }
                      }}
                      className="w-full px-2 py-1.5 border-2 border-indigo-200 rounded text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                      placeholder="300 000"
                    />
                  </div>

                  <div className="space-y-2">
                    {processes.map((process, index) => {
                      const { yearlySavings } = calculateProcessSavings(process);
                      
                      return (
                        <div key={process.id} className="bg-gray-50 rounded-lg p-2 relative">
                          <div className="flex items-center justify-between mb-2">
                            <h3 className="text-sm font-semibold text-gray-700">
                              Процесс {index + 1}
                            </h3>
                            {processes.length > 1 && (
                              <button
                                onClick={() => removeProcess(process.id)}
                                className="text-red-500 hover:text-red-700"
                              >
                                <Trash2 className="w-4 h-4" />
                              </button>
                            )}
                          </div>

                          <div className="space-y-1.5">
                            <input
                              type="text"
                              value={process.name}
                              onChange={(e) => updateProcess(process.id, 'name', e.target.value)}
                              className="w-full px-2 py-1 border border-gray-300 rounded text-xs focus:ring-1 focus:ring-indigo-500"
                              placeholder="Название процесса"
                            />

                            <div className="grid grid-cols-4 gap-1.5">
                              <div>
                                <label className="block text-xs text-gray-600 mb-0.5">
                                  Время ДО<br/>
                                  <span className="text-[10px] text-gray-500">(мин/задача)</span>
                                </label>
                                <input
                                  type="number"
                                  value={process.timeBefore}
                                  onChange={(e) => updateProcess(process.id, 'timeBefore', Number(e.target.value))}
                                  className="w-full px-2 py-1 border border-gray-300 rounded text-xs focus:ring-1 focus:ring-indigo-500"
                                  placeholder="15"
                                />
                              </div>
                              <div>
                                <label className="block text-xs text-gray-600 mb-0.5">
                                  Время ПОСЛЕ<br/>
                                  <span className="text-[10px] text-gray-500">(мин/задача)</span>
                                </label>
                                <input
                                  type="number"
                                  value={process.timeAfter}
                                  onChange={(e) => updateProcess(process.id, 'timeAfter', Number(e.target.value))}
                                  className="w-full px-2 py-1 border border-gray-300 rounded text-xs focus:ring-1 focus:ring-indigo-500"
                                  placeholder="5"
                                />
                              </div>
                              <div>
                                <label className="block text-xs text-gray-600 mb-0.5">
                                  Кол-во задач<br/>
                                  <span className="text-[10px] text-gray-500">(в месяц)</span>
                                </label>
                                <input
                                  type="number"
                                  value={process.tasksPerMonth}
                                  onChange={(e) => updateProcess(process.id, 'tasksPerMonth', Number(e.target.value))}
                                  className="w-full px-2 py-1 border border-gray-300 rounded text-xs focus:ring-1 focus:ring-indigo-500"
                                  placeholder="500"
                                />
                              </div>
                              <div>
                                <label className="block text-xs text-gray-600 mb-0.5">
                                  Стоимость<br/>
                                  <span className="text-[10px] text-gray-500">(₽/час сотр.)</span>
                                </label>
                                <input
                                  type="number"
                                  value={process.hourlyCost}
                                  onChange={(e) => updateProcess(process.id, 'hourlyCost', Number(e.target.value))}
                                  className="w-full px-2 py-1 border border-gray-300 rounded text-xs focus:ring-1 focus:ring-indigo-500"
                                  placeholder="1000"
                                />
                              </div>
                            </div>

                            {yearlySavings > 0 && (
                              <div className="bg-green-50 rounded p-1.5 border border-green-200">
                                <div className="text-xs text-gray-600">
                                  Экономия: <span className="font-bold text-green-700">{formatNumber(yearlySavings)} ₽/год</span>
                                </div>
                              </div>
                            )}
                          </div>
                        </div>
                      );
                    })}
                  </div>

                  <button
                    onClick={addProcess}
                    className="mt-2 w-full py-1.5 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 font-semibold rounded text-xs flex items-center justify-center gap-1"
                  >
                    <Plus className="w-3 h-3" />
                    Добавить процесс
                  </button>

                  <div className="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-lg p-3 text-white mt-3">
                    <h2 className="text-sm font-bold mb-2">Итого</h2>

                    <div className="grid grid-cols-2 gap-2 mb-2">
                      <div className="bg-white bg-opacity-20 rounded p-2 backdrop-blur-sm">
                        <div className="text-xs opacity-90">Экономия/год</div>
                        <div className="text-sm font-bold">{formatNumber(totalYearlySavings)} ₽</div>
                      </div>

                      <div className="bg-white bg-opacity-20 rounded p-2 backdrop-blur-sm">
                        <div className="text-xs opacity-90">Внедрение</div>
                        <div className="text-sm font-bold">{formatNumber(implementationCost)} ₽</div>
                      </div>

                      <div className="bg-white bg-opacity-20 rounded p-2 backdrop-blur-sm">
                        <div className="text-xs opacity-90">ROI</div>
                        <div className="text-sm font-bold">
                          {roi > 0 ? '+' : ''}{formatNumber(roi)}%
                        </div>
                      </div>

                      <div className="bg-white bg-opacity-20 rounded p-2 backdrop-blur-sm">
                        <div className="text-xs opacity-90">Окупаемость</div>
                        <div className="text-sm font-bold">
                          {paybackMonths > 0 && paybackMonths < 100 
                            ? `${paybackMonths.toFixed(2)} мес` 
                            : paybackMonths >= 100 
                            ? '> 8 лет'
                            : '—'}
                        </div>
                      </div>
                    </div>

                    {totalYearlySavings > 0 && (
                      <div className="bg-white bg-opacity-10 rounded p-2 backdrop-blur-sm">
                        <p className="text-xs opacity-90">
                          {roi > 100 && paybackMonths < 12 
                            ? '🎯 Отличная инвестиция!'
                            : roi > 50 && paybackMonths < 24
                            ? '✅ Хорошая инвестиция'
                            : roi > 0 && paybackMonths < 36
                            ? '⚠️ Умеренная эффективность'
                            : '❌ Пересмотрите параметры'}
                        </p>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            </div>
          );
        }

        ReactDOM.render(<ROICalculator />, document.getElementById('root'));
    </script>
</body>
</html>